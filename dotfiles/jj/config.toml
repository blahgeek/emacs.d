"$schema" = "https://jj-vcs.github.io/jj/latest/config-schema.json"

[user]
name = "Yikai Zhao"
email = "yikai@z1k.dev"

[ui]
default-command = ["log", "--limit=10"]
diff-editor = "magit-as-diff-tool"
diff-formatter = ":git"
conflict-marker-style = "git"

[templates]
git_push_bookmark = '"z1k/jj-" ++ change_id.short()'
draft_commit_description = '''
concat(
  builtin_draft_commit_description,
  "\nJJ: ignore-rest\n",
  diff.git(),
)
'''

[revset-aliases]
# exclude "*alpha*" tags from immutable
"immutable_heads()" = '''builtin_immutable_heads() ~ ( tags("alpha") ~ (untracked_remote_bookmarks() | trunk()) )'''

[git]
# private-commits = "description(glob:'debug:*') | description(glob:'private:*') | description(glob:'tmp:*')"
private-commits = "description(glob:'private:*')"

[aliases]
e = ["edit"]
init = ["git", "init", "--colocate"]
push = ["git", "push"]
fetch = ["git", "fetch"]

tug = ["util", "exec", "--", "bash", "-c", '''
jj bookmark move --from "heads(::@- & bookmarks())" --to "${1:-@-}"
''', "argv0"]

pre-commit = ["util", "exec", "--", "bash", "-c", '''
jj diff -r ${1:-@} --name-only --no-pager | xargs pre-commit run --files
''', "argv0"]

push-mr = ["util", "exec", "--", "jj-push-mr"]
